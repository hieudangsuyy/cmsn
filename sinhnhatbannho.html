<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday Matrix & Fireworks</title>
    <style>
        body { margin: 0; overflow: hidden; background: black; font-family: 'Arial', sans-serif; }
        canvas { position: absolute; top: 0; left: 0; }
        .content {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            text-align: center; color: #ffffff;
            text-shadow: 0 0 10px #ffffff, 0 0 20px #ffffff; z-index: 10;
            pointer-events: none;
        }
        #text-display { font-size: 4rem; white-space: pre-line; transition: all 0.4s ease-in-out; }
    </style>
</head>
<body>
    <canvas id="matrixCanvas"></canvas>
    <canvas id="fireworkCanvas"></canvas>
    <div class="content"><h1 id="text-display"></h1></div>

    <script>
        const mCanvas = document.getElementById('matrixCanvas');
        const mCtx = mCanvas.getContext('2d');
        const fCanvas = document.getElementById('fireworkCanvas');
        const fCtx = fCanvas.getContext('2d');

        mCanvas.width = fCanvas.width = window.innerWidth;
        mCanvas.height = fCanvas.height = window.innerHeight;

        const chars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        const fontSize = 16;
        const columns = mCanvas.width / fontSize;
        const drops = Array(Math.floor(columns)).fill(1);

        function drawMatrix() {
            mCtx.fillStyle = "rgba(0, 0, 0, 0.1)";
            mCtx.fillRect(0, 0, mCanvas.width, mCanvas.height);
            mCtx.fillStyle = "#ffffff";
            mCtx.font = fontSize + "px arial";
            for (let i = 0; i < drops.length; i++) {
                const text = chars.charAt(Math.floor(Math.random() * chars.length));
                mCtx.fillText(text, i * fontSize, drops[i] * fontSize);
                if (drops[i] * fontSize > mCanvas.height && Math.random() > 0.975) drops[i] = 0;
                drops[i]++;
            }
        }

        let particles = [];
        class Particle {
            constructor(x, y) {
                this.x = x; this.y = y;
                this.size = Math.random() * 3 + 1;
                this.speedX = Math.random() * 6 - 3;
                this.speedY = Math.random() * 6 - 3;
                this.opacity = 1;
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.opacity -= 0.02;
            }
            draw() {
                fCtx.fillStyle = rgba(255, 255, 255, ${this.opacity});
                fCtx.beginPath();
                fCtx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                fCtx.fill();
            }
        }

        function createFirework() {
            const x = Math.random() * fCanvas.width;
            const y = Math.random() * fCanvas.height;
            for (let i = 0; i < 30; i++) particles.push(new Particle(x, y));
        }

        function handleParticles() {
            fCtx.clearRect(0, 0, fCanvas.width, fCanvas.height);
            for (let i = 0; i < particles.length; i++) {
                particles[i].update();
                particles[i].draw();
                if (particles[i].opacity <= 0) {
                    particles.splice(i, 1);
                    i--;
                }
            }
        }

        // --- ĐIỀU KHIỂN NỘI DUNG (Đã sửa bỏ chữ "nữa") ---
        const textDisplay = document.getElementById('text-display');
        const messages = [
            "3", "2", "1", 
            "Happy Birthday", 
            "Bạn Nhỏ :3", 
            "02.01.2008", 
            "Chúc Mừng\nTuổi 18 Đẹp Đẽ", 
            "Rực Rỡ", 
            "Ngày Càng\nXinh Đẹp", 
            "Và Giỏi Giang", 
            "❤️"
        ];
        let messageIndex = 0;
        let isBirthdayReached = false;

        function updateText() {
            if (messageIndex < messages.length) {
                const currentMsg = messages[messageIndex];
                textDisplay.innerText = currentMsg;
                if (currentMsg === "Happy Birthday") isBirthdayReached = true;
                messageIndex++;
                setTimeout(updateText, 1800);
            }
        }

        function animate() {
            drawMatrix();
            handleParticles();
            if (isBirthdayReached && Math.random() > 0.9) createFirework();
            requestAnimationFrame(animate);
        }

        animate();
        updateText();

        window.addEventListener('resize', () => {
            mCanvas.width = fCanvas.width = window.innerWidth;
            mCanvas.height = fCanvas.height = window.innerHeight;
        });
    </script>
</body>
</html>